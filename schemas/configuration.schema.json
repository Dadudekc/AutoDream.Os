{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://agent-cellphone-v2.os/schemas/configuration.schema.json",
  "title": "Agent Cellphone V2 Configuration Schema",
  "description": "Unified validation schema for all configuration files using Repository pattern",
  "type": "object",
  "required": [
    "version",
    "last_updated",
    "configuration_type",
    "validation_rules"
  ],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Semantic version of the configuration schema"
    },
    "last_updated": {
      "type": "string",
      "format": "date-time",
      "description": "Last modification timestamp"
    },
    "configuration_type": {
      "type": "string",
      "enum": [
        "unified",
        "messaging",
        "discord",
        "coordinates",
        "semantic",
        "agent_aliases",
        "devlog"
      ],
      "description": "Type of configuration being validated"
    },
    "validation_rules": {
      "type": "object",
      "required": ["required_fields", "coordinate_bounds", "file_organization"],
      "properties": {
        "required_fields": {
          "type": "object",
          "additionalProperties": {
            "type": "array",
            "items": { "type": "string" }
          },
          "description": "Required fields for each configuration type"
        },
        "coordinate_bounds": {
          "type": "object",
          "required": ["min_x", "max_x", "min_y", "max_y"],
          "properties": {
            "min_x": { "type": "integer", "minimum": -3000 },
            "max_x": { "type": "integer", "maximum": 3000 },
            "min_y": { "type": "integer", "minimum": 0 },
            "max_y": { "type": "integer", "maximum": 2000 }
          },
          "description": "Valid coordinate boundaries for agent positioning"
        },
        "file_organization": {
          "type": "object",
          "required": ["config_files", "schema_files", "archive_files"],
          "properties": {
            "config_files": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of configuration files"
            },
            "schema_files": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of schema files"
            },
            "archive_files": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of archived files"
            }
          },
          "description": "File organization structure"
        }
      },
      "description": "Validation rules for configuration files"
    },
    "ssot_compliance": {
      "type": "object",
      "required": ["single_source", "references", "dependencies"],
      "properties": {
        "single_source": {
          "type": "boolean",
          "description": "Whether this is a single source of truth"
        },
        "references": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Files referenced by this configuration"
        },
        "dependencies": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Configuration dependencies"
        }
      },
      "description": "Single Source of Truth compliance rules"
    },
    "v2_compliance": {
      "type": "object",
      "required": ["file_size_compliant", "module_structure", "documentation"],
      "properties": {
        "file_size_compliant": {
          "type": "boolean",
          "description": "Whether file meets V2 size requirements (â‰¤400 lines)"
        },
        "module_structure": {
          "type": "string",
          "enum": ["factory", "repository", "observer", "singleton"],
          "description": "Architectural pattern used"
        },
        "documentation": {
          "type": "object",
          "required": ["has_docstrings", "has_examples", "has_type_hints"],
          "properties": {
            "has_docstrings": { "type": "boolean" },
            "has_examples": { "type": "boolean" },
            "has_type_hints": { "type": "boolean" }
          },
          "description": "Documentation compliance"
        }
      },
      "description": "V2 compliance requirements"
    },
    "migration_info": {
      "type": "object",
      "properties": {
        "consolidated_from": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Files consolidated into this configuration"
        },
        "consolidated_date": {
          "type": "string",
          "format": "date-time",
          "description": "Date of consolidation"
        },
        "consolidated_by": {
          "type": "string",
          "description": "Agent responsible for consolidation"
        },
        "mission": {
          "type": "string",
          "description": "Mission code for this consolidation"
        }
      },
      "description": "Information about configuration migration"
    }
  },
  "additionalProperties": false
}
