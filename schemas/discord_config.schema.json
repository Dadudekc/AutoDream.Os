{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://agent-cellphone-v2.os/schemas/discord_config.schema.json",
  "title": "Agent Cellphone V2 Discord Configuration Schema",
  "description": "Validation schema for Discord bot and channel configurations",
  "type": "object",
  "required": [
    "version",
    "last_updated",
    "bot_config",
    "channel_config"
  ],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Schema version"
    },
    "last_updated": {
      "type": "string",
      "format": "date-time",
      "description": "Last modification timestamp"
    },
    "bot_config": {
      "type": "object",
      "required": ["bot_settings", "permissions", "agent_settings", "logging", "features"],
      "properties": {
        "bot_settings": {
          "type": "object",
          "required": ["command_prefix", "command_timeout", "max_concurrent_commands", "response_timeout"],
          "properties": {
            "command_prefix": { "type": "string", "minLength": 1 },
            "command_timeout": { "type": "integer", "minimum": 60 },
            "max_concurrent_commands": { "type": "integer", "minimum": 1, "maximum": 50 },
            "response_timeout": { "type": "integer", "minimum": 300 }
          },
          "description": "Core bot operational settings"
        },
        "permissions": {
          "type": "object",
          "required": ["allowed_channels", "admin_users", "restricted_commands"],
          "properties": {
            "allowed_channels": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of allowed channel IDs"
            },
            "admin_users": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of admin user IDs"
            },
            "restricted_commands": {
              "type": "array",
              "items": { "type": "string" },
              "description": "List of restricted command names"
            }
          },
          "description": "Bot permission configuration"
        },
        "agent_settings": {
          "type": "object",
          "required": ["max_prompt_length", "max_swarm_message_length", "response_tracking", "command_history_limit"],
          "properties": {
            "max_prompt_length": { "type": "integer", "minimum": 1000, "maximum": 4000 },
            "max_swarm_message_length": { "type": "integer", "minimum": 500, "maximum": 2000 },
            "response_tracking": { "type": "boolean" },
            "command_history_limit": { "type": "integer", "minimum": 50, "maximum": 500 }
          },
          "description": "Agent-specific bot settings"
        },
        "logging": {
          "type": "object",
          "required": ["enable_command_logging", "enable_response_logging", "log_file", "log_level"],
          "properties": {
            "enable_command_logging": { "type": "boolean" },
            "enable_response_logging": { "type": "boolean" },
            "log_file": { "type": "string", "pattern": "\\.log$" },
            "log_level": {
              "type": "string",
              "enum": ["DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"]
            }
          },
          "description": "Logging configuration"
        },
        "features": {
          "type": "object",
          "required": ["enable_prompt_commands", "enable_status_commands", "enable_swarm_commands", "enable_help_commands", "enable_admin_commands"],
          "properties": {
            "enable_prompt_commands": { "type": "boolean" },
            "enable_status_commands": { "type": "boolean" },
            "enable_swarm_commands": { "type": "boolean" },
            "enable_help_commands": { "type": "boolean" },
            "enable_admin_commands": { "type": "boolean" }
          },
          "description": "Feature enablement flags"
        },
        "integrations": {
          "type": "object",
          "required": ["webhook_notifications", "agent_response_tracking", "status_updates"],
          "properties": {
            "webhook_notifications": { "type": "boolean" },
            "agent_response_tracking": { "type": "boolean" },
            "status_updates": { "type": "boolean" }
          },
          "description": "Integration settings"
        }
      },
      "description": "Discord bot configuration"
    },
    "channel_config": {
      "type": "object",
      "patternProperties": {
        "^agent-[1-8]$|^swarm-(general|coordination|alerts)$": {
          "type": "object",
          "required": ["name", "webhook_url", "channel_id", "description", "agent", "color", "enabled", "permissions"],
          "properties": {
            "name": { "type": "string", "minLength": 1 },
            "webhook_url": { 
              "type": ["string", "null"],
              "format": "uri"
            },
            "channel_id": { 
              "type": ["string", "null"],
              "pattern": "^[0-9]{17,19}$"
            },
            "description": { "type": "string", "minLength": 1 },
            "agent": { 
              "type": ["string", "null"],
              "pattern": "^Agent-[1-8]$"
            },
            "color": { "type": "integer", "minimum": 0, "maximum": 16777215 },
            "enabled": { "type": "boolean" },
            "permissions": {
              "type": "object",
              "required": ["read_messages", "send_messages", "embed_links", "attach_files", "mention_everyone"],
              "properties": {
                "read_messages": { "type": "boolean" },
                "send_messages": { "type": "boolean" },
                "embed_links": { "type": "boolean" },
                "attach_files": { "type": "boolean" },
                "mention_everyone": { "type": "boolean" }
              },
              "description": "Channel permission settings"
            }
          },
          "description": "Individual channel configuration"
        }
      },
      "additionalProperties": false,
      "description": "Discord channel configurations"
    },
    "validation_rules": {
      "type": "object",
      "required": ["channel_naming", "color_validation", "permission_consistency"],
      "properties": {
        "channel_naming": {
          "type": "object",
          "required": ["agent_pattern", "swarm_pattern"],
          "properties": {
            "agent_pattern": { "type": "string", "pattern": "^agent-[1-8]$" },
            "swarm_pattern": { "type": "string", "pattern": "^swarm-(general|coordination|alerts)$" }
          },
          "description": "Channel naming conventions"
        },
        "color_validation": {
          "type": "object",
          "required": ["min_color", "max_color", "unique_colors"],
          "properties": {
            "min_color": { "type": "integer", "minimum": 0 },
            "max_color": { "type": "integer", "maximum": 16777215 },
            "unique_colors": { "type": "boolean" }
          },
          "description": "Color validation rules"
        },
        "permission_consistency": {
          "type": "object",
          "required": ["admin_channels", "restricted_permissions"],
          "properties": {
            "admin_channels": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Channels with admin permissions"
            },
            "restricted_permissions": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Restricted permission combinations"
            }
          },
          "description": "Permission consistency rules"
        }
      },
      "description": "Discord configuration validation rules"
    }
  },
  "additionalProperties": false
}
